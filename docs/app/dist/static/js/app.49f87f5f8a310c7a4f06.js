webpackJsonp([0],{"/Bt8":function(e,t){},0:function(e,t){},B2mF:function(e,t){Array.prototype.pluck=function(e){var t=[];return this.forEach(function(i,r){t.push(i[e])}),t},Array.prototype.pluckMap=function(e){var t=this;Array.isArray(e)||(e=[e]);var i=[];return e.forEach(function(e){i[e]=[],t.forEach(function(t){i[e].push(t[e])})}),i},window.getElementTop=function(e,t){var i=e.offsetTop;return e.offsetParent!=t&&(i=i-e.offsetParent.scrollTop+getElementTop(e.offsetParent,t)),i},window.isArray=function(e){return"[object Array]"===Object.prototype.toString.call(e)}},E51W:function(e,t){},GyAO:function(e,t){},OC5I:function(e,t){},VrJe:function(e,t){},eksW:function(e,t){},g6T9:function(e,t){},kPFz:function(e,t){},lVK7:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});i("E51W"),i("VrJe");var r=i("7+uW"),n={data:function(){return{open:!1,trigger:null,newServerUrl:"",newServerName:"",selectedServerNum:0,serverSet:[{name:"阿里云服务器",url:"http://47.94.15.53:8010/"},{name:"本地服务器",url:"http://local-api.hse.com/"}]}},computed:{selectedServer:{get:function(){return this.selectedServerNum},set:function(e){this.selectedServerNum=e,this.emitChange()}},selectedServerObj:{get:function(){return this.serverSet[this.selectedServer]}}},mounted:function(){this.trigger=this.$refs.button.$el,this.selectedServer=0},methods:{toggle:function(){this.open=!this.open,this.open&&this.resetInput()},resetInput:function(){this.newServerUrl="http://",this.newServerName="新建服务器"},handleClose:function(e){this.open=!1},emitChange:function(){this.$emit("serverChanged")},submit:function(){var e=this,t=!0;if(this.serverSet.forEach(function(i){if(i.url==e.newServerUrl)return t=!1,!1}),t){var i={name:this.newServerName,url:this.newServerUrl},r=this.serverSet.push(i);this.selectedServer=r-1,this.toggle()}else app.hint("已经存在相同URL的服务器地址")}}},a={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("mu-paper",{staticClass:"select-server-paper",attrs:{zDepth:1}},[i("mu-select-field",{ref:"serverSelect",staticClass:"select-server",attrs:{label:"选择api服务器"},model:{value:e.selectedServer,callback:function(t){e.selectedServer=t},expression:"selectedServer"}},e._l(e.serverSet,function(e,t){return i("mu-menu-item",{key:e.url,attrs:{value:t,title:e.name}})})),e._v(" "),i("mu-float-button",{ref:"button",staticClass:"add-server-btn",attrs:{icon:"add",secondary:"",mini:""},on:{click:e.toggle}}),e._v(" "),i("mu-popover",{attrs:{trigger:e.trigger,open:e.open,anchorOrigin:{vertical:"center",horizontal:"right"},targetOrigin:{vertical:"center",horizontal:"left"},id:"add-server-pop",popoverClass:"add-server-pop"},on:{close:e.handleClose}},[i("mu-paper",{staticClass:"add-server-form"},[i("mu-text-field",{staticClass:"server-name-input",attrs:{label:"服务器名称",spellcheck:"false"},model:{value:e.newServerName,callback:function(t){e.newServerName=t},expression:"newServerName"}}),i("br"),e._v(" "),i("mu-text-field",{staticClass:"server-select-input",attrs:{label:"添加服务器",hintText:"新的API服务器地址",spellcheck:"false"},model:{value:e.newServerUrl,callback:function(t){e.newServerUrl=t},expression:"newServerUrl"}}),i("br"),e._v(" "),i("mu-float-button",{ref:"button",staticClass:"submit-new-server-btn",attrs:{icon:"done",secondary:"",mini:""},on:{click:function(t){e.submit()}}})],1)],1)],1)},staticRenderFns:[]};var s=i("VU/8")(n,a,!1,function(e){i("OC5I")},null,null).exports,o={data:function(){return{hints:[]}},computed:{hasHint:function(){return!(!this.hints||!this.hints.length)}},methods:{hint:function(e,t){var i=this;t||(t=2500),this.hints.unshift({message:e,timestamp:(new Date).valueOf()}),setTimeout(function(){i.hints.splice(i.hints.indexOf(e),1)},t)}}},l={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("mu-popup",{attrs:{position:"top",overlay:!1,popupClass:"pop-up-hint-queue",open:e.hasHint}},[i("transition-group",{attrs:{name:"hint-message"}},e._l(e.hints,function(t){return i("mu-paper",{key:JSON.stringify(t),staticClass:"pop-up-hint"},[e._v(e._s(t.message))])}))],1)},staticRenderFns:[]};var u=i("VU/8")(o,l,!1,function(e){i("kPFz")},null,null).exports,c={props:{apiList:null},methods:{menuClick:function(e,t){app.$emit("onApiMenuClicked",{url:e,menuOffset:getElementTop(t.path[0])})}}},p={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return null!=e.apiList&&0!=e.apiList.length?i("mu-list",{staticClass:"api-menu-list"},e._l(e.apiList,function(t,r){return i("mu-list-item",{key:r,attrs:{title:r.toUpperCase(),toggleNested:""}},[i("mu-icon",{staticClass:"folder-icon",attrs:{slot:"left",value:"folder"},slot:"left"}),e._v(" "),e._l(t,function(t,r){return i("mu-list-item",{key:r,attrs:{slot:"nested",title:t.name?t.name:t.url,describeText:t.name?t.url:"",inset:""},on:{click:function(i){e.menuClick(t.url,i)}},slot:"nested"},[i("mu-icon",{attrs:{slot:"left",value:t.icon?t.icon:"toc"},slot:"left"})],1)})],2)})):e._e()},staticRenderFns:[]};var d=i("VU/8")(c,p,!1,function(e){i("x2el")},null,null).exports,h={data:function(){return{createTimeShow:!1,modifyTimeShow:!1,createTimeTooltipTrigger:null,modifyTimeTooltipTrigger:null}},props:{api:null},computed:{apiPro:function(){var e=this.api,t=e.param;if(t&&t.forEach(function(e){e.hasOwnProperty("selected")||Vue.set(e,"selected",!0)}),e.hasOwnProperty("createTime")){var i=new Date(1e3*e.createTime),r=i.getMonth()+1,n=i.getDate(),a=i.getHours(),s=a<12?"上午":"下午";Vue.set(e,"createTimeFormatted",r+"月"+n+"日 "+s+a+"点")}if(e.hasOwnProperty("modifyTime")){var o=new Date(1e3*e.modifyTime),l=o.getMonth()+1,u=o.getDate(),c=o.getHours(),p=c<12?"上午":"下午";Vue.set(e,"modifyTimeFormatted",l+"月"+u+"日 "+p+c+"点")}return e},urlConnected:function(){if(this.typedInUrl)return this.typedInUrl;var e=app.selectedServer.url+this.api.url,t="",i=!1;return this.apiPro.param&&(this.apiPro.param.forEach(function(e){e.selected&&(i&&(t+="&"),e.hasOwnProperty("inputVal")?t+=e.name+"="+e.inputVal:t+=""+e.name,i=!0)}),t.length&&(e+="?"+t)),e}},mounted:function(){this.createTimeTooltipTrigger=this.$refs.createTimeIcon,this.modifyTimeTooltipTrigger=this.$refs.modifyTimeIcon},methods:{showCreateTime:function(){this.createTimeShow=!0},hideCreateTime:function(){this.createTimeShow=!1},showModifyTime:function(){this.modifyTimeShow=!0},hideModifyTime:function(){this.modifyTimeShow=!1},setTypedUrl:function(e){this.typedInUrl=e.target.value}},watch:{"api.param":{deep:!0,handler:function(){this.typedInUrl=null}}}},f={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"api-detail-list-item"},[i("div",{staticClass:"api-detail-info"},[e.apiPro.icon?i("mu-icon",{staticClass:"api-detail-icon",attrs:{slot:"left",value:e.apiPro.icon,size:244},slot:"left"}):e._e(),e._v(" "),i("div",{staticClass:"api-detail-url"},[e._v("\n            "+e._s(e.apiPro.url)+" \n            "),e.apiPro.modifyTimeFormatted?i("div",{ref:"modifyTimeIcon",staticClass:"modifyTime tooltip-icon",on:{mouseenter:e.showModifyTime,mouseleave:e.hideModifyTime}},[i("mu-icon",{attrs:{value:"brush",size:"28"}}),e._v(" "),i("mu-tooltip",{attrs:{show:e.modifyTimeShow,trigger:e.modifyTimeTooltipTrigger,label:"最后修改于 "+e.apiPro.modifyTimeFormatted,verticalPosition:"bottom",horizontalPosition:"left"}})],1):e._e(),e._v(" "),e.apiPro.createTimeFormatted?i("div",{ref:"createTimeIcon",staticClass:"createTime tooltip-icon",on:{mouseenter:e.showCreateTime,mouseleave:e.hideCreateTime}},[i("mu-icon",{attrs:{value:"add_circle",size:"28"}}),e._v(" "),i("mu-tooltip",{attrs:{show:e.createTimeShow,trigger:e.createTimeTooltipTrigger,label:"创建于 "+e.apiPro.createTimeFormatted,verticalPosition:"bottom",horizontalPosition:"left"}})],1):e._e()]),e._v(" "),e.apiPro.name?i("div",{staticClass:"api-detail-name"},[e._v(e._s(e.apiPro.name))]):e._e()],1),e._v(" "),e.apiPro.param&&e.apiPro.param.length?i("mu-table",{class:"api-detail-param",attrs:{showCheckbox:!1}},[i("mu-thead",[i("mu-tr",[i("mu-th",{attrs:{width:"10%"}},[e._v("选择")]),e._v(" "),i("mu-th",[e._v("名称")]),e._v(" "),i("mu-th",[e._v("释义")]),e._v(" "),i("mu-th",{attrs:{width:"20%"}},[e._v("输入")]),e._v(" "),i("mu-th",{attrs:{width:"10%"}},[e._v("是否必须")]),e._v(" "),i("mu-th",[e._v("类型")]),e._v(" "),i("mu-th",[e._v("允许值、默认值")]),e._v(" "),i("mu-th",[e._v("备注")])],1)],1),e._v(" "),i("mu-tbody",e._l(e.apiPro.param,function(t){return i("mu-tr",{key:t.name},[i("mu-td",[i("mu-checkbox",{attrs:{disabled:t.required},model:{value:t.selected,callback:function(i){e.$set(t,"selected",i)},expression:"param.selected"}}),e._v(" "),i("br")],1),e._v(" "),i("mu-td",{attrs:{title:t.name}},[e._v(e._s(t.name))]),e._v(" "),i("mu-td",{attrs:{title:t.desc}},[e._v(e._s(t.desc))]),e._v(" "),i("mu-td",[i("mu-text-field",{staticClass:"param-val-input",attrs:{hintText:"param.desc",fullWidth:"",spellcheck:"false"},model:{value:t.inputVal,callback:function(i){e.$set(t,"inputVal",i)},expression:"param.inputVal"}})],1),e._v(" "),i("mu-td",{attrs:{title:t.required?"必须":"非必需"}},[i("mu-icon",{attrs:{value:t.required?"done":"clear",size:24}})],1),e._v(" "),i("mu-td",{attrs:{title:t.type}},[e._v(e._s(t.type?t.type:"未指定"))]),e._v(" "),i("mu-td",{attrs:{title:t.valueAllowed}},[e._v(e._s(t.valueAllowed)+" \n                    "+e._s(t.hasOwnProperty("default")?" => "+t.default:""))]),e._v(" "),i("mu-td",{attrs:{title:t.desc}},[e._v(e._s(t.desc))])],1)}))],1):i("div",{staticClass:"api-detail-param no-param"},[e._v("此API无需任何参数")]),e._v(" "),i("div",{staticClass:"api-detail-send"},[i("mu-text-field",{attrs:{label:"请求发送地址",labelFloat:"",spellcheck:"false"},on:{change:e.setTypedUrl},model:{value:e.urlConnected,callback:function(t){e.urlConnected=t},expression:"urlConnected"}}),e._v(" "),i("mu-raised-button",{attrs:{label:"发送",secondary:""}})],1)],1)},staticRenderFns:[]};var m={data:function(){return{apiList:[]}},components:{ApiListPageItem:i("VU/8")(h,f,!1,function(e){i("eksW")},null,null).exports},computed:{apiListArrayed:function(){var e=[];for(var t in window.apiList=this.apiList,this.apiList)if(this.apiList.hasOwnProperty(t))for(var i in this.apiList[t])if(this.apiList[t].hasOwnProperty(i)){var r=this.apiList[t][i];e.push(r)}return e}},mounted:function(){var e=this;app.$on("onApiRefreshed",function(t){e.$set(e,"apiList",t.apiList)}),app.$on("onApiMenuClicked",function(t){var i=document.querySelectorAll(".api-detail-list-item[data-url='"+t.url+"']")[0],r=document.getElementsByClassName("api-detail-list-ctn")[0],n=t.menuOffset,a=Math.max(Math.min(i.offsetTop-n+100,i.offsetTop-48),i.offsetTop-r.offsetHeight+i.offsetHeight),s=1,o=1,l=a>r.scrollTop?1:-1;window.requestAnimationFrame(function e(){o+=s+=1,r.scrollTop+=o*l,1==l&&r.scrollTop>a||-1==l&&r.scrollTop<a?r.scrollTop=a:window.requestAnimationFrame(e)}),e.apiListArrayed.forEach(function(e){Vue.set(e,"hightlighted",!1),e.url==t.url&&Vue.set(e,"hightlighted",!0)})})}},v={render:function(){var e=this.$createElement,t=this._self._c||e;return this.apiListArrayed.length?t("div",{staticClass:"api-detail-list-ctn"},this._l(this.apiListArrayed,function(e){return t("api-list-page-item",{key:e.url,class:e.hightlighted?["hightlighted"]:[],attrs:{"data-url":e.url,api:e}})})):this._e()},staticRenderFns:[]};var g={data:function(){return{currentPageKey:0,pageKeySeq:0,pages:[]}},props:{pagesOnInit:[]},components:{ApiListPage:i("VU/8")(m,v,!1,function(e){i("GyAO")},null,null).exports},computed:{pageHeaders:function(){return this.pages.pluck("header")}},methods:{spawnPageKey:function(){return this.pageKeySeq++,this.pageKeySeq},pushPage:function(e){var t={header:{key:this.spawnPageKey(),title:e.title},content:{type:e.type,dataDelivered:e.dataDelivered}};this.pages.push(t),e.activate&&this.activePage(t.header.key)},activePage:function(e){this.currentPageKey=e}},mounted:function(){var e=this;this.pagesOnInit&&this.pagesOnInit.forEach(function(t){e.pushPage(t)})}},_={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return e.pages.length?i("div",{staticClass:"tab-pages-ctn"},[i("mu-tabs",{attrs:{value:e.currentPageKey}},e._l(e.pageHeaders,function(t){return i("mu-tab",{key:t.key,attrs:{title:t.title,value:t.key},on:{click:function(i){e.activePage(t.key)}}})})),e._v(" "),e._l(e.pages,function(t){return e.currentPageKey==t.header.key?i("api-list-page",{key:t.header.key,tag:"component",attrs:{dataDelivered:t.content.dataDelivered}}):e._e()})],2):e._e()},staticRenderFns:[]};var y={components:{ServerSelector:s,HintQueue:u,ApiMenuList:d,TabPage:i("VU/8")(g,_,!1,function(e){i("/Bt8")},null,null).exports},data:function(){return{selectedServer:null,refreshTrigger:null,refreshing:!1,apiList:[]}},methods:{hint:function(e,t){return this.$refs.hintQueue.hint(e,t)},refreshApiList:function(){var e=this;this.selectedServer&&(this.refreshing=!0,Vue.http.get(this.selectedServer.url+"sys/api",{params:{requireRedundant:1}}).then(function(t){t.body&&t.body.success&&(app.$emit("onApiRefreshed",{apiList:t.body.data}),e.apiList=t.body.data,e.hint("API列表已刷新",1400)),e.refreshing=!1},function(t){e.hint("网络请求错误",2e3),e.refreshing=!1,console.log(t)}))},changeServer:function(){this.selectedServer=this.$refs.serverSelector.selectedServerObj,this.refreshApiList()}},mounted:function(){this.refreshTrigger=this.$refs.refreshList}},T={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"page-split",attrs:{id:"app"}},[i("hint-queue",{ref:"hintQueue"}),e._v(" "),i("div",{staticClass:"split-cell split-cell-left"},[i("mu-appbar",{attrs:{title:"API列表"}},[i("mu-flat-button",{attrs:{slot:"right",label:"刷新页面",onclick:"window.location.reload();"},slot:"right"})],1),e._v(" "),i("div",{ref:"refreshList",staticClass:"api-list-ctn"},[i("mu-refresh-control",{attrs:{refreshing:e.refreshing,trigger:e.refreshTrigger},on:{refresh:e.refreshApiList}}),e._v(" "),i("server-selector",{ref:"serverSelector",on:{serverChanged:e.changeServer}}),e._v(" "),i("api-menu-list",{attrs:{apiList:e.apiList}})],1)],1),e._v(" "),i("div",{staticClass:"split-cell split-cell-right"},[i("tab-page",{attrs:{pagesOnInit:[{title:"API列表",type:"api-list-page",dataDelivered:[],activate:!0}]}})],1)],1)},staticRenderFns:[]};var w=i("VU/8")(y,T,!1,function(e){i("g6T9")},null,null).exports,S=i("u64Q"),b=i.n(S),C=i("8+8L");i("B2mF");r.default.config.productionTip=!1,r.default.use(C.a),r.default.use(b.a),r.default.config.silent=!0,window.Vue=r.default,window.appContainer=new r.default({el:"#app",components:{App:w},template:'<App ref="app"/>',mounted:function(){window.app=this.$refs.app}})},x2el:function(e,t){}},["lVK7"]);
//# sourceMappingURL=app.49f87f5f8a310c7a4f06.js.map